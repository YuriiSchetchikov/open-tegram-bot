import telebot
import logging
from pyowm import OWM
from pyowm.utils.config import get_default_config
from pyowm.utils import timestamps

logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

owm = OWM('169eea5f4be9901c9d8adb9aee11773c')
mgr = owm.weather_manager()
config_dict = get_default_config()
config_dict['language'] = 'ru'
owm = OWM('169eea5f4be9901c9d8adb9aee11773c', config_dict)
client = telebot.TeleBot("–í–∞—à API –∫–ª—é—á")


@client.message_handler(commands=['help'])
def start_bot(message):
	help_comm = "–î–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å –ø–æ–≥–æ–¥—É –≤ —Ç–æ–º –∏–ª–∏ –∏–Ω–æ–º –≥–æ—Ä–æ–¥–µ –≤–≤–µ–¥–∏—Ç–µ –µ–≥–æ –Ω–∞–∑–≤–∞–Ω–∏–µ.\n–í–ê–ñ–ù–û –ø–∏—à–∏ –Ω–∞–∑–≤–∞–Ω–∏—è –≥–æ—Ä–æ–¥–æ–≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –∞ —Ç–æ —è –º–æ–≥—É –æ—Ç–∫–ª—é—á–∏—Ç—å—Å—èü§í"
	client.send_message(message.chat.id,help_comm)

@client.message_handler(commands=['start'])
def start_bot(message):
	start = f"<b>–î–æ–±—Ä–æ –ü–æ–∂–∞–ª–æ–≤–∞—Ç—å {message.from_user.first_name}!</b>\n –î–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å –ø–æ–≥–æ–¥—É –≤ —Ç–æ–º –∏–ª–∏ –∏–Ω–æ–º –≥–æ—Ä–æ–¥–µ –≤–≤–µ–¥–∏—Ç–µ –µ–≥–æ –Ω–∞–∑–≤–∞–Ω–∏–µ:"
	client.send_message(message.chat.id,start,parse_mode='html')

@client.message_handler(content_types=['text'])
def send_answer(message):
	observation = mgr.weather_at_place(message.text)
	w = observation.weather
	w.wind()
	w.humidity
	temp = w.temperature('celsius')['temp']

	answer = "–í –≥–æ—Ä–æ–¥–µ " + message.text + " —Å–µ–π—á–∞—Å " + w.detailed_status + "\n"
	answer += "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —Å–µ–π—á–∞—Å " + str(temp) + "¬∞C." + "\n\n"

	if temp < -5:
		answer += "–ù–∞ —É–ª–∏—Ü–µ —Å–∏–ª—å–Ω—ã–π –º–æ—Ä–æ–∑, –æ–¥–µ–≤–∞–π—Å—è —Ç–µ–ø–ª–æ ü•∂"
	elif temp < 0:
		answer+="–ù–∞ —É–ª–∏—Ü–µ –º–æ—Ä–æ–∑, –æ–¥–µ–≤–∞–π—Å—è —Ç–µ–ø–ª–æ ü•∂."
	elif temp < 10:
		answer+="–ö–∞–∫-—Ç–æ –ø—Ä–æ—Ö–ª–∞–¥–Ω–æ, –æ–¥–µ–≤–∞–π—Å—è –ø–æ—Ç–µ–ø–ª–µ–µ üôÇ."
	elif temp < 17:
		answer+= "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –ø—Ä–∏–µ–º–ª–∏–º–∞—è, –Ω–æ –æ–¥–µ—Ç—å—Å—è —Å—Ç–æ–∏—Ç üòä."
	else:
		answer+= "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –æ—Ç–ª–∏—á–Ω–∞—è –æ–¥–µ–≤–∞–π—Å—è –≤–æ —á—Ç–æ —Ö–æ—á–µ—à—å üòâ."
	client.send_message(message.chat.id,answer)


if __name__ == '__main__':
	client.polling( none_stop=True )
